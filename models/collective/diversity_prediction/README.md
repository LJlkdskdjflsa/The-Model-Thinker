# å¤šæ¨£æ€§é æ¸¬å®šç† (Diversity Prediction Theorem)

## ðŸ“š ç†è«–ä»‹ç´¹

å¤šæ¨£æ€§é æ¸¬å®šç†æ˜¯ä¸€å€‹é‡è¦çš„æ•¸å­¸æ†ç­‰å¼ï¼Œè§£é‡‹äº†ç‚ºä»€éº¼å¤šæ¨£æ€§çš„æ¨¡åž‹é›†åˆåœ¨é æ¸¬æ–¹é¢å¾€å¾€å„ªæ–¼å–®å€‹æ¨¡åž‹ã€‚é€™å€‹å®šç†ç‚ºã€Œç¾¤é«”çš„æ™ºæ…§ã€(Wisdom of Crowds) æä¾›äº†æ•¸å­¸åŸºç¤Žï¼Œä¹Ÿæ˜¯æ©Ÿå™¨å­¸ç¿’ä¸­é›†æˆæ–¹æ³• (Ensemble Method) æˆåŠŸçš„ç†è«–æ”¯æ’ã€‚

### æ ¸å¿ƒå…§å®¹

**å®šç†é™³è¿°**ï¼š
å¤šæ¨¡åž‹èª¤å·® = å¹³å‡æ¨¡åž‹èª¤å·® - æ¨¡åž‹é æ¸¬çš„å¤šæ¨£æ€§

### æ•¸å­¸å…¬å¼

å°æ–¼ N å€‹æ¨¡åž‹çš„é æ¸¬çµæžœï¼š

```
é›†é«”èª¤å·® = (MÌ„ - V)Â²
å¹³å‡å€‹é«”èª¤å·® = (1/N) Ã— Î£(Máµ¢ - V)Â²
é æ¸¬å¤šæ¨£æ€§ = (1/N) Ã— Î£(Máµ¢ - MÌ„)Â²
```

å…¶ä¸­ï¼š
- Máµ¢ æ˜¯æ¨¡åž‹ i çš„é æ¸¬å€¼
- MÌ„ æ˜¯æ‰€æœ‰æ¨¡åž‹é æ¸¬çš„å¹³å‡å€¼
- V æ˜¯çœŸå¯¦å€¼
- N æ˜¯æ¨¡åž‹æ•¸é‡

**æ ¸å¿ƒæ†ç­‰å¼**ï¼š
```
é›†é«”èª¤å·® = å¹³å‡å€‹é«”èª¤å·® - é æ¸¬å¤šæ¨£æ€§
```

## ðŸš€ å¿«é€Ÿé–‹å§‹

### é‹è¡Œç°¡å–®æ¼”ç¤º

```bash
# é‹è¡Œæ ¸å¿ƒè¨ˆç®—æ¼”ç¤ºï¼ˆç„¡éœ€è¦–è¦ºåŒ–åº«ï¼‰
python diversity_prediction/diversity_simple.py
```

### ä»£ç¢¼ç¤ºä¾‹

```python
from diversity_simple import DiversityPredictionSimple

# å‰µå»ºæ¨¡åž‹å¯¦ä¾‹
model = DiversityPredictionSimple()

# æ¨¡åž‹é æ¸¬ï¼š[2, 8]ï¼ŒçœŸå¯¦å€¼ï¼š4
predictions = [2, 8]
true_value = 4

# è¨ˆç®—å„é …æŒ‡æ¨™
collective_error = model.collective_error(predictions, true_value)
avg_individual_error = model.average_individual_error(predictions, true_value)
diversity = model.prediction_diversity(predictions)

print(f"é›†é«”èª¤å·®: {collective_error}")        # 1.0
print(f"å¹³å‡å€‹é«”èª¤å·®: {avg_individual_error}")  # 10.0
print(f"é æ¸¬å¤šæ¨£æ€§: {diversity}")             # 9.0

# é©—è­‰æ†ç­‰å¼
print(f"æ†ç­‰å¼é©—è­‰: {collective_error} = {avg_individual_error} - {diversity}")
```

## ðŸ“Š å¯¦é©—çµæžœ

### å¯¦é©—1ï¼šå¥§æ–¯å¡çŽé æ¸¬ç¤ºä¾‹

| æ¨¡åž‹ | é æ¸¬å€¼ | å€‹é«”èª¤å·® | èˆ‡å¹³å‡å€¼å·®ç•° |
|------|--------|----------|-------------|
| æ¨¡åž‹1 | 2é … | 4 | -3 |
| æ¨¡åž‹2 | 8é … | 16 | +3 |
| **å¹³å‡** | **5é …** | **10** | **0** |
| **çœŸå¯¦å€¼** | **4é …** | - | - |

**è¨ˆç®—çµæžœ**ï¼š
- é›†é«”èª¤å·®ï¼š1
- å¹³å‡å€‹é«”èª¤å·®ï¼š10
- é æ¸¬å¤šæ¨£æ€§ï¼š9
- **é©—è­‰**ï¼š1 = 10 - 9 âœ“

### å¯¦é©—2ï¼šå¤šæ¨£æ€§å°æº–ç¢ºæ€§çš„å½±éŸ¿

| å ´æ™¯ | æ¨¡åž‹1 | æ¨¡åž‹2 | æ¨¡åž‹3 | é›†é«”èª¤å·® | å¤šæ¨£æ€§ |
|------|-------|-------|-------|----------|--------|
| é«˜å¤šæ¨£æ€§ | 10 | 30 | 50 | 0 | 266.67 |
| ä¸­å¤šæ¨£æ€§ | 25 | 30 | 35 | 0 | 16.67 |
| ä½Žå¤šæ¨£æ€§ | 29 | 30 | 31 | 0 | 0.67 |
| ç„¡å¤šæ¨£æ€§ | 30 | 30 | 30 | 0 | 0 |

*è¨»ï¼šçœŸå¯¦å€¼å‡ç‚º30*

### å¯¦é©—3ï¼šåå·®æ¨¡åž‹çš„å½±éŸ¿

ç•¶æ‰€æœ‰æ¨¡åž‹éƒ½æœ‰ç›¸åŒåå·®æ™‚ï¼š

| å ´æ™¯ | æ¨¡åž‹1 | æ¨¡åž‹2 | æ¨¡åž‹3 | çœŸå¯¦å€¼ | é›†é«”èª¤å·® |
|------|-------|-------|-------|--------|----------|
| æ­£åå·® | 35 | 40 | 45 | 30 | 100 |
| è² åå·® | 25 | 20 | 15 | 30 | 100 |

## ðŸ” é—œéµæ´žå¯Ÿ

### 1. èª¤å·®æŠµæ¶ˆæ©Ÿåˆ¶
- **ç›¸åèª¤å·®**ï¼šé«˜ä¼°å’Œä½Žä¼°çš„æ¨¡åž‹ç›¸äº’æŠµæ¶ˆ
- **å¤šæ¨£æ€§åƒ¹å€¼**ï¼šä¸åŒé¡žåž‹çš„æ¨¡åž‹å¸¶ä¾†ä¸åŒè¦–è§’
- **å¹³å‡æ•ˆæ‡‰**ï¼šæ¥µç«¯é æ¸¬è¢«å¹³å‡åŒ–

### 2. å¤šæ¨£æ€§çš„é‡è¦æ€§
é æ¸¬å¤šæ¨£æ€§è¶Šå¤§ï¼Œé›†é«”èª¤å·®çš„æ”¹å–„è¶Šæ˜Žé¡¯ï¼š
- å¤šæ¨£æ€§ = 0ï¼šé›†é«” = å¹³å‡å€‹é«”èª¤å·®
- å¤šæ¨£æ€§ > 0ï¼šé›†é«” < å¹³å‡å€‹é«”èª¤å·®
- é«˜å¤šæ¨£æ€§ï¼šå¯èƒ½å¤§å¹…æ”¹å–„é æ¸¬æº–ç¢ºæ€§

### 3. å…±åŒåå·®çš„é™åˆ¶
å¦‚æžœæ‰€æœ‰æ¨¡åž‹éƒ½æœ‰ç›¸åŒçš„ç³»çµ±æ€§åå·®ï¼š
- å¤šæ¨£æ€§ç„¡æ³•æ¶ˆé™¤å…±åŒåå·®
- é›†é«”é æ¸¬ä»æœƒåŒ…å«è©²åå·®
- éœ€è¦ä¸åŒé¡žåž‹çš„æ¨¡åž‹ä¾†é¿å…

## ðŸŽ¯ å¯¦éš›æ‡‰ç”¨æ¡ˆä¾‹

### æ¡ˆä¾‹1ï¼šå¤©æ°£é æ¸¬
```python
# ä¸åŒæ°£è±¡æ¨¡åž‹çš„çµ„åˆ
weather_models = DiversityPredictionSimple()

# æ¨¡åž‹é æ¸¬æ˜Žæ—¥æœ€é«˜æº«åº¦ï¼ˆÂ°Cï¼‰
predictions = [25, 28, 22, 30]  # 4å€‹ä¸åŒæ¨¡åž‹
true_temp = 26

collective_error = weather_models.collective_error(predictions, true_temp)
diversity = weather_models.prediction_diversity(predictions)

print(f"é›†é«”é æ¸¬æº«åº¦: {sum(predictions)/len(predictions):.1f}Â°C")
print(f"é æ¸¬å¤šæ¨£æ€§å¸¶ä¾†çš„æ”¹å–„: {diversity:.2f}")
```

### æ¡ˆä¾‹2ï¼šè‚¡ç¥¨åƒ¹æ ¼é æ¸¬
```python
# æŠ€è¡“åˆ†æž vs åŸºæœ¬é¢åˆ†æž
stock_models = DiversityPredictionSimple()

# é æ¸¬è‚¡åƒ¹è®ŠåŒ– (%)
technical_analysis = [+5, +8, +3]    # æŠ€è¡“é¢çœ‹æ¼²
fundamental_analysis = [-2, 0, +1]   # åŸºæœ¬é¢ä¿å®ˆ
all_predictions = technical_analysis + fundamental_analysis

actual_change = 3  # å¯¦éš›ä¸Šæ¼²3%

# æ¯”è¼ƒä¸åŒçµ„åˆçš„æ•ˆæžœ
tech_error = stock_models.collective_error(technical_analysis, actual_change)
fund_error = stock_models.collective_error(fundamental_analysis, actual_change)
combined_error = stock_models.collective_error(all_predictions, actual_change)

print(f"ç´”æŠ€è¡“åˆ†æžèª¤å·®: {tech_error:.2f}")
print(f"ç´”åŸºæœ¬é¢åˆ†æžèª¤å·®: {fund_error:.2f}")
print(f"çµ„åˆåˆ†æžèª¤å·®: {combined_error:.2f}")
```

### æ¡ˆä¾‹3ï¼šé†«ç™‚è¨ºæ–·åˆ†æ•¸
```python
# ä¸åŒå°ˆç§‘é†«ç”Ÿçš„è¨ºæ–·ä¿¡å¿ƒåˆ†æ•¸
medical_prediction = DiversityPredictionSimple()

# ç—…æƒ…åš´é‡ç¨‹åº¦è©•åˆ† (1-10)
cardiologist = 7     # å¿ƒè‡Ÿç§‘ï¼šä¸­ç­‰åš´é‡
neurologist = 4      # ç¥žç¶“ç§‘ï¼šè¼•å¾®
internist = 6        # å…§ç§‘ï¼šä¸­ç­‰
emergency = 8        # æ€¥è¨ºç§‘ï¼šè¼ƒåš´é‡

predictions = [cardiologist, neurologist, internist, emergency]
actual_severity = 6  # å¯¦éš›åš´é‡ç¨‹åº¦

diversity_benefit = medical_prediction.prediction_diversity(predictions)
print(f"å°ˆç§‘æ„è¦‹å¤šæ¨£æ€§åƒ¹å€¼: {diversity_benefit:.2f}")
```

## ðŸ¤– æ©Ÿå™¨å­¸ç¿’ä¸­çš„æ‡‰ç”¨

### é›†æˆå­¸ç¿’ (Ensemble Learning)
```python
# æ¨¡æ“¬ä¸åŒç®—æ³•çš„é æ¸¬çµæžœ
ml_ensemble = DiversityPredictionSimple()

# æˆ¿åƒ¹é æ¸¬ (è¬å…ƒ)
random_forest = 520
gradient_boosting = 480
neural_network = 540
linear_regression = 460

predictions = [random_forest, gradient_boosting, neural_network, linear_regression]
actual_price = 500

# è¨ˆç®—é›†æˆæ•ˆæžœ
ensemble_prediction = sum(predictions) / len(predictions)
improvement = ml_ensemble.prediction_diversity(predictions)

print(f"é›†æˆé æ¸¬: {ensemble_prediction}è¬å…ƒ")
print(f"å¤šæ¨£æ€§å¸¶ä¾†çš„æ”¹å–„: {improvement:.2f}")
```

### Bagging vs Boosting
- **Bagging**ï¼šé€éŽéš¨æ©Ÿå–æ¨£å¢žåŠ æ¨¡åž‹å¤šæ¨£æ€§
- **Boosting**ï¼šé€éŽåºåˆ—è¨“ç·´é—œæ³¨å›°é›£æ¨£æœ¬
- **éš¨æ©Ÿæ£®æž—**ï¼šçµåˆå…©è€…å„ªå‹¢ï¼Œæœ€å¤§åŒ–å¤šæ¨£æ€§

## âš ï¸ æ¨¡åž‹å±€é™æ€§

1. **æ†ç­‰å¼æ€§è³ª**ï¼šé€™æ˜¯æ•¸å­¸æ†ç­‰å¼ï¼Œç¸½æ˜¯æˆç«‹
2. **å…±åŒåå·®**ï¼šç„¡æ³•æ¶ˆé™¤æ‰€æœ‰æ¨¡åž‹å…±æœ‰çš„ç³»çµ±æ€§èª¤å·®
3. **å¤šæ¨£æ€§å“è³ª**ï¼šç„¡æ„ç¾©çš„å¤šæ¨£æ€§ä¸æœƒå¸¶ä¾†æ”¹å–„
4. **ç¨ç«‹æ€§è¦æ±‚**ï¼šæ¨¡åž‹é–“æ‡‰ç›¡å¯èƒ½ç¨ç«‹
5. **æˆæœ¬è€ƒé‡**ï¼šç¶­è­·å¤šå€‹æ¨¡åž‹çš„æˆæœ¬å¯èƒ½å¾ˆé«˜

## ðŸ“ˆ å„ªåŒ–ç­–ç•¥

### 1. å¢žåŠ æœ‰æ„ç¾©çš„å¤šæ¨£æ€§
- ä½¿ç”¨ä¸åŒçš„ç®—æ³•
- åŸºæ–¼ä¸åŒçš„ç‰¹å¾µé›†
- é‡‡ç”¨ä¸åŒçš„è¨“ç·´æ•¸æ“š
- æ‡‰ç”¨ä¸åŒçš„é è™•ç†æ–¹æ³•

### 2. é¿å…å…±åŒåå·®
- æª¢æŸ¥æ•¸æ“šæ”¶é›†åå·®
- ä½¿ç”¨å¤šå…ƒåŒ–çš„è¨“ç·´é›†
- é¿å…æ¨¡åž‹é–“çš„éŽåº¦ç›¸é—œ
- å®šæœŸé©—è­‰å’Œæ›´æ–°æ¨¡åž‹

### 3. å‹•æ…‹æ¬Šé‡åˆ†é…
- æ ¹æ“šæ­·å²è¡¨ç¾èª¿æ•´æ¬Šé‡
- è€ƒæ…®æ¨¡åž‹çš„é©ç”¨å ´æ™¯
- å¯¦æ–½åœ¨ç·šå­¸ç¿’æ©Ÿåˆ¶

## ðŸ“‚ æ–‡ä»¶çµæ§‹

```
diversity_prediction/
â”œâ”€â”€ README.md              # æœ¬æ–‡æª”
â”œâ”€â”€ diversity_simple.py    # æ ¸å¿ƒå¯¦ç¾ï¼ˆç„¡ä¾è³´ï¼‰
â”œâ”€â”€ diversity_prediction.py # å®Œæ•´å¯¦ç¾ï¼ˆå«è¦–è¦ºåŒ–ï¼‰
â”œâ”€â”€ demo.py                # äº’å‹•å¼æ¼”ç¤º
â””â”€â”€ test.py                # æ¸¬è©¦è…³æœ¬
```

## ðŸ”— å»¶ä¼¸é–±è®€

- Page, S. E. (2007). *The Difference: How the Power of Diversity Creates Better Groups*
- Surowiecki, J. (2004). *The Wisdom of Crowds*, Chapter on Diversity and Decentralization
- Breiman, L. (2001). "Random Forests" - å¤šæ¨£æ€§åœ¨æ©Ÿå™¨å­¸ç¿’ä¸­çš„æ‡‰ç”¨
- Page, S. E. (2018). *The Model Thinker*, Chapter on Prediction and Forecasting
- Wolpert, D. H. (1992). "Stacked Generalization" - é›†æˆå­¸ç¿’çš„ç†è«–åŸºç¤Ž

## ðŸ’¡ æ€è€ƒé¡Œ

1. ç‚ºä»€éº¼ã€Œæ›´å¤šæ¨£æ€§ã€ä¸ç¸½æ˜¯æ„å‘³è‘—ã€Œæ›´å¥½çš„é æ¸¬ã€ï¼Ÿ
2. åœ¨ä»€éº¼æƒ…æ³ä¸‹ï¼Œå–®å€‹å„ªç§€æ¨¡åž‹æœƒå„ªæ–¼å¤šå€‹æ™®é€šæ¨¡åž‹çš„çµ„åˆï¼Ÿ
3. å¦‚ä½•åœ¨å¯¦éš›æ‡‰ç”¨ä¸­æ¸¬é‡å’Œæœ€å¤§åŒ–é æ¸¬å¤šæ¨£æ€§ï¼Ÿ
4. å¤šæ¨£æ€§é æ¸¬å®šç†èˆ‡åå·®-æ–¹å·®æ¬Šè¡¡æœ‰ä»€éº¼é—œä¿‚ï¼Ÿ
5. å¦‚ä½•å°‡æ­¤å®šç†æ‡‰ç”¨æ–¼äººé¡žåœ˜éšŠçš„æ±ºç­–éŽç¨‹ï¼Ÿ
6. åœ¨æ·±åº¦å­¸ç¿’æ™‚ä»£ï¼Œå‚³çµ±é›†æˆæ–¹æ³•çš„åƒ¹å€¼å¦‚ä½•ï¼Ÿ